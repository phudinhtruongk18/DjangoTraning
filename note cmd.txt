account:
    admin
    phu.truong@hdwebsoft.io
    123123

git:
    git clone https://github.com/LondonAppDeveloper/deploy-django-with-docker-compose --config core.autocrlf=false
    # stuck in this shit when deploy in docker
    # https://stackoverflow.com/a/53165472/13226749 this this one


cmd:
    docker-compose build

    docker-compose run --rm app sh -c "django-admin startproject app ."
    docker-compose run --rm app sh -c "python manage.py createsuperuser"

    docker-compose -f docker-compose-deploy.yml down --volumes
    docker-compose down --volumes --remove-orphans flag
    # TAKE IT DOWN (cause make some error with the one before)

    docker-compose -f docker-compose-deploy.yml build
    docker-compose -f docker-compose-deploy.yml up

% tam thoi bo dong nay o db
restart: always


% tam thoi bo dong nay o db
# RUN apk update && apk add libpq

# atomic transaction
{
'ATOMIC_REQUESTS': True,   in DATABASES in setting
    from django.db import transaction

    def viewfunc(request):
    # This code executes in autocommit mode (Django's default).
    do_stuff()

    with transaction.atomic():
    # This code executes inside a transaction.
    do_more_stuff()
}

# Run all the tests in the animals.tests module
$ ./manage.py test animals.tests


# one line admin register
echo "from django.contrib.auth import get_user_model; User = get_user_model(); User.objects.create_superuser(username='admin',email='admin@myproject.com', password='123123')" | python manage.py shell
echo "from django.contrib.auth import get_user_model; User = get_user_model(); User.objects.create_superuser(email='admin@myproject.com', password='123123',first_name='Dinh',last_name='Phu',username='admin')" | python manage.py shell

# DELETE AN APP 
    Step 1: empty the app, but leave it installed
    remove all files from the app, except the folder "migrations"

    Execute this command:
    python manage.py makemigrations -n drop_all_tables my_app_to_remove
    Leave my_app_to_remove in the file "settings.py".
    Step 2: Deploy the changes
    Update all projects. Tell the team mates to update their project and to run the migrations.
    Step 3: remove "my_app_to_remove" from settings.py
    Now remove "my_app_to_remove" from settings.py and deploy again.


REPLACE LATER: template register navbar